# 第二次阶段报告

## 我的任务：语法分析（LL（1）分析法自动生成分析表）

#### 当前所做的：

​	1.确定所需要的产生式，构建产生表。通过讨论，了解到一个语言所需要的产生式文法，并在有限的时间内不断修改，优化，最终得到较为可行的产生式文法。用得到的产生式文法来生成分析表

​	2.读入终结符，非终结符，产生式。终结符和非终结符可以从产生式中统计，也可以在词法分析时统计。为了省去调用和计算的时间，最终选择前者，由于最终产生式文法已经确定，直接在指定目录的文本文件中保存预留的终结符、非终结符和29行左右的产生式，在程序运行时自动读入并展开分析。

​	3.构建分析表，利用LL（1）分析法进行语法分析，先求first集，再求非终结符的follow集，然后得到select集。最终完成分析表的构成，通过table二维数组存储。

​	4.修改输出类型，与组长进行讨论和交流后将端口统一修改，尽可能避免组员之间互相使用对方的代码部分时产生错误和类型不匹配。

​	5.在阶段报告前已完成语法分析的初步设计，能实现分析表的生成和代码的检验。准备继续优化和查找错误。

​	6.新增实现去掉include和注释的简单功能。实现对保留代码主体的要求。

​	7.新增实现检查标识符是否存在未定义便使用或者重定义的简单功能，实现在词法分析时对代码的检查。

​	8.进一步优化LL（1）分析过程，同时添加多组数据来验证功能完整性和正确性，最终结果都符合预期要求。

​	7.新增实现检查标识符是否存在未定义便使用或者重定义的简单功能，实现在词法分析时对代码的检查。

#### 1.语法分析设计：

##### 	1.1数据的定义

​		map<string,int> Getnu;//用标号记录每个非终结符和终结符

​		string Getch[100];//标号对应的非终结符和终结符

​		vector< string > Process;//单个生成式组合，例如A->bAc存储为A bAc先读取非终结符，空格分开，后面为表达式

​		vector< string > Production;//存储去掉首的非终结符

​		int table[100] [100];//分析表

​		int num=0;//终结符加上非终结符的数量

​		int numvt=0; //终结符和非终结符分界点，改标号表示的是空，用@表示

​		string first[100];//first集

​		string follow[200];follow集

​		string word;需要检测的代码

##### 	1.2函数的定义

​		void readin();//预读，读入终结符，非终结符，和产生式文法

​		void Intersection(string &a,string b);//取a,b交集赋值给a

​		string Getf(int v,int & H0);//求first集时首尾情况考虑

​		void Getfirst();//得到first集

​		void Printfirst();//打印first集

​		void Getfollow();//得到follow集

​		void Printfollow();//打印follow集

​		void Gettable();//得到分析表

​		string Getp(int i);//查找分析表对应的内容

​		void PrintT();//打印分析表

​		string Gainfirst(string sb)//获取产生式左式的非终结符首

​		string Gainsecond(string sb)//获取产生式的右式首词

​		（新增）void edit()//去除include using 和注释所包含的内容

​		（新增）bool redef_or_notdef()//在词法分析过程检查重定义和未定义情况

##### 	1.3主程序内容

int main()

{

  readin();

  Getfirst();

  Printfirst();

  int n=4;

  while(n--)

  {

​    Getfollow();

  }

  Printfollow();

  Gettable();

  PrintT();

  system("pause");

  return 0;

}

### 2.实验中遇到的问题

​	由于基础的编译原理知识的缺乏，和对编程的一窍不通，导致我刚开始完全不知道该做什么，比如select怎么求，分析表怎么构建，follow集有没有求完整等等，但在组长的帮助下，我最终开始发奋复习，并着重查看了第四章的语法分析内容，了解了LL（1）分析法的基本操作步骤，同时运用到编程中，并逐步完成了前半阶段的课程设计环节。
​	在调试方面，由于产生式文法对于我来说可能有点庞大，所以发现第一次生成的分析表出现了缺的情况，在讨论后发现是follow集缺失而产生的selcet集问题。进过一番更改，分析表逐渐完善。

​	在第二次阶段报告前，又依照组长要求添加了几个功能，但其中重定义和未定义的检测需要结合词法分析来编写代码，但词法分析为其他组员提供，因此在研究代码段和token系列生成情况上又花费了一些时间。

### 3.下一步工作的计划

​	首先是继续完善语法分析部分，争取能发现潜在的bug和不足，做到完善现有代码的目的，之后的工作会继续听从组长指挥，多与组员进行讨论和统一，使课程设计的程序更加完善。同时还要不断学习，了解其他组员的工作细节，可以在端口调用上帮助或获得一些指导和意见。课设也步入尾声，争取将自己部分的代码和功能做到最完善。
